#!/bin/bash -eu

WORKBRANCH=$(dirname $(dirname $(readlink -f "${BASH_SOURCE[0]}")))
PAGESBRANCH=${PAGESBRANCH:-${WORKBRANCH}-build}

cd "${WORKBRANCH}"
make clean html
(cd "${PAGESBRANCH}" && git pull --rebase)
cp -R build/html/* "${PAGESBRANCH}"
cd "${PAGESBRANCH}"
git add --all .
git commit -am "New build"
git push origin gh-pages
